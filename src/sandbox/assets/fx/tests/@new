// The buffer contains indicies of dead particles.
RWStructuredBuffer<uint> uavDeadIndices: register(u0);


// The buffer contains the state of the particles, Alive or dead.
RWBuffer<uint> uavStates: register(u1);


struct Part
{
	float3 speed;
	float3 pos;
	float size;
	float timelife;
};

// The buffer contains user-defined particle data.
RWStructuredBuffer<Part> uavParticles: register(u2);


[numthreads(1, 1, 1)]
void CSParticlesResetRoutine(uint3 Gid: SV_GroupID, uint GI: SV_GroupIndex, uint3 GTid: SV_GroupThreadID, uint3 DTid: SV_DispatchThreadID)
{
	uint tid = DTid.x;
	if (tid >= 1000) return;
	uavDeadIndices[tid] = tid;
	uavStates[tid] = 0;
	Part Particle;
	Particle.speed = float3(0.f, 0.f, 0.f);
	Particle.pos = float3(0.f, 0.f, 0.f);
	Particle.size = 0.f;
	Particle.timelife = 0.f;
	uavParticles[tid] = Particle;
}
